// SPDX-License-Identifier: PMPL-1.0-or-later
= Missing Security Components - Full Audit Report
:toc: left

== Executive Summary

This document catalogs ALL missing security components across the svalinn-project ecosystem based on the comprehensive audit performed on 2026-01-28.

**Audit Date:** 2026-01-28
**Auditor:** Claude Code (Sonnet 4.5)
**Scope:** Cerro Torre, Svalinn, V√∂r√∞r, selur, verified-container-spec
**Reference Standard:** svalinn-project security specification

---

== CRITICAL Missing Components

=== 1. Post-Quantum Cryptography (ML-DSA-87)

**Status:** STUB ONLY (API defined, not implemented)

**Affected Repos:**
- ‚ùå Cerro Torre: `src/core/ct_pqcrypto.ads` returns `NOT_IMPLEMENTED`
- ‚ùå V√∂r√∞r: No ML-DSA-87 verification at all
- ‚ùå Svalinn: No PQ crypto support
- ‚ö†Ô∏è  verified-container-spec: Spec doesn't mandate ML-DSA-87

**Impact:**
- Containers signed today won't be verifiable in quantum era (20+ years)
- No defense against "harvest now, decrypt later" attacks

**Fix Required:**
```bash
# Cerro Torre
cd /var/mnt/eclipse/repos/cerro-torre
# Add liboqs Ada bindings
# Implement Sign_ML_DSA_87 / Verify_ML_DSA_87 functions
# Link to ct_pqcrypto.adb

# V√∂r√∞r
cd /var/mnt/eclipse/repos/vordr
# Add liboqs to Cargo.toml
# Implement verification matching Cerro Torre
```

**Estimated Effort:** 4-8 weeks (Ada FFI to liboqs)

---

=== 2. Post-Quantum TLS (Kyber-1024 KEM)

**Status:** NOT AVAILABLE (Deno limitation)

**Affected Repos:**
- ‚ùå Svalinn: Deno uses BoringSSL (no PQ-TLS)
- ‚ùå Cerro Torre: Registry client uses HTTP/2 (no PQ)
- ‚ùå V√∂r√∞r: Rust reqwest uses system OpenSSL (usually no PQ)

**Impact:**
- TLS handshakes vulnerable to quantum computers
- Session keys can be recovered retroactively

**Fix Required:**

**Option 1: Wait for Deno PQ-TLS support**
```bash
# Monitor Deno roadmap for OQS-BoringSSL integration
# Track: https://github.com/denoland/deno/issues
```

**Option 2: Switch Svalinn from Deno to Rust**
```bash
# Use Hyper + Rustls + liboqs
# Loses Deno's simplicity but gains PQ-TLS control
```

**Option 3: Nginx/Caddy Frontend**
```bash
# Put nginx with OQS-OpenSSL in front of Svalinn
# Terminate PQ-TLS at nginx, forward plaintext to Svalinn
```

**Estimated Effort:**
- Option 1: 6-12 months (wait for Deno)
- Option 2: 2-3 months (Rust rewrite)
- Option 3: 1-2 weeks (nginx config)

---

=== 3. OWASP ModSecurity / Firewalld Rules

**Status:** COMPLETELY MISSING (no WAF, no firewalld configs)

**Affected Repos:**
- ‚ùå Svalinn: No firewalld zones, no ModSecurity rules
- ‚ùå All repos: No OWASP Top 10 defenses configured

**What's Missing:**

#### Firewalld Configuration

**Required Files (NOT FOUND):**
```
/var/mnt/eclipse/repos/svalinn/
  config/
    firewalld/
      zones/
        svalinn-edge.xml       # Public-facing edge zone
        svalinn-internal.xml   # Internal service zone
      services/
        svalinn-https.xml      # Custom service definition
      policies/
        svalinn-drop.xml       # Default-deny policy
```

**Firewalld Rules Needed:**
```xml
<!-- svalinn-edge.xml -->
<zone>
  <short>Svalinn Edge Gateway</short>
  <service name="https"/>  <!-- 443 only -->
  <service name="http"/>   <!-- 80 redirect to 443 -->
  <rule family="ipv4">
    <source address="0.0.0.0/0"/>
    <service name="https"/>
    <accept/>
  </rule>
  <rule family="ipv6">
    <source address="::/0"/>
    <service name="https"/>
    <accept/>
  </rule>
</zone>
```

#### OWASP ModSecurity Core Rule Set (CRS)

**Required Files (NOT FOUND):**
```
/var/mnt/eclipse/repos/svalinn/
  config/
    modsecurity/
      modsecurity.conf         # Main ModSecurity config
      crs/                     # OWASP CRS rules
        REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf
        REQUEST-901-INITIALIZATION.conf
        ...
        RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf
```

**OWASP Top 10 Defenses Needed:**

| OWASP Risk | Defense | Status |
|------------|---------|--------|
| A01:2021 - Broken Access Control | RBAC + JWT verification | ‚ö†Ô∏è JWT implemented, RBAC missing |
| A02:2021 - Cryptographic Failures | TLS 1.3 + strong ciphers | ‚ö†Ô∏è TLS yes, PQ no |
| A03:2021 - Injection | Input validation + parameterized queries | ‚ö†Ô∏è JSON schema validation exists |
| A04:2021 - Insecure Design | Threat modeling + security requirements | ‚ö†Ô∏è Spec exists, enforcement missing |
| A05:2021 - Security Misconfiguration | Hardened configs + CSP headers | ‚ùå No CSP, no security headers |
| A06:2021 - Vulnerable Components | Dependency scanning + updates | ‚ö†Ô∏è Dependabot enabled (GitHub) |
| A07:2021 - Identification Failures | MFA + session management | ‚ö†Ô∏è OAuth2 yes, MFA no |
| A08:2021 - Software Integrity Failures | Code signing + SBOM | ‚ö†Ô∏è SBOM spec exists, not enforced |
| A09:2021 - Logging Failures | Structured logging + SIEM | ‚ö†Ô∏è Logs exist, no SIEM |
| A10:2021 - SSRF | URL validation + allowlists | ‚ùå No SSRF protection |

**Fix Required:**

**Step 1: Add Firewalld Configs**
```bash
cd /var/mnt/eclipse/repos/svalinn
mkdir -p config/firewalld/{zones,services,policies}

# Create svalinn-edge.xml (public zone)
cat > config/firewalld/zones/svalinn-edge.xml <<'EOF'
<?xml version="1.0" encoding="utf-8"?>
<zone>
  <short>Svalinn Edge</short>
  <description>Public-facing HTTPS gateway with strict firewall</description>
  <service name="https"/>
  <service name="http"/>  <!-- Redirect to HTTPS -->
  <rule family="ipv4">
    <source address="0.0.0.0/0"/>
    <port protocol="tcp" port="443"/>
    <accept/>
  </rule>
  <rule family="ipv6">
    <source address="::/0"/>
    <port protocol="tcp" port="443"/>
    <accept/>
  </rule>
</zone>
EOF
```

**Step 2: Install ModSecurity**
```bash
# For production deployment
sudo dnf install mod_security mod_security_crs  # Fedora
# or
sudo apt install libapache2-mod-security2 modsecurity-crs  # Debian/Ubuntu
```

**Step 3: Configure OWASP CRS**
```bash
cd /var/mnt/eclipse/repos/svalinn
mkdir -p config/modsecurity

# Copy OWASP CRS rules
cp -r /usr/share/modsecurity-crs/* config/modsecurity/

# Create custom config
cat > config/modsecurity/svalinn-custom.conf <<'EOF'
# Svalinn-specific ModSecurity rules

# Block SQL injection
SecRule ARGS "@detectSQLi" \
  "id:1001,phase:2,block,msg:'SQL Injection Detected'"

# Block XSS
SecRule ARGS "@detectXSS" \
  "id:1002,phase:2,block,msg:'XSS Attack Detected'"

# Block SSRF (Server-Side Request Forgery)
SecRule ARGS "@rx ^https?://(localhost|127\\.0\\.0\\.1|::1)" \
  "id:1003,phase:2,block,msg:'SSRF Attack Blocked'"

# Rate limiting (100 req/min per IP)
SecAction "id:1004,phase:1,nolog,pass,initcol:ip=%{REMOTE_ADDR}"
SecRule IP:RATE "@gt 100" \
  "id:1005,phase:2,block,msg:'Rate Limit Exceeded'"
EOF
```

**Step 4: Security Headers**

Currently missing from Svalinn HTTP responses:

```typescript
// Add to Svalinn middleware (src/middleware/Security.res)
let securityHeaders = (c: Context.t) => {
  c->Context.header("Strict-Transport-Security", "max-age=31536000; includeSubDomains; preload")
  c->Context.header("X-Frame-Options", "DENY")
  c->Context.header("X-Content-Type-Options", "nosniff")
  c->Context.header("X-XSS-Protection", "1; mode=block")
  c->Context.header("Content-Security-Policy", "default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-ancestors 'none'")
  c->Context.header("Referrer-Policy", "strict-origin-when-cross-origin")
  c->Context.header("Permissions-Policy", "geolocation=(), microphone=(), camera=()")
  c
}
```

**Estimated Effort:**
- Firewalld configs: 1 day
- ModSecurity integration: 2-3 days
- Security headers: 1 day
- Testing: 2-3 days
- **Total: 1 week**

---

=== 4. Command Injection Vulnerabilities

**Status:** CRITICAL SECURITY BUGS (CVSS 8.5-9.0)

**Affected Repo:** verified-container-spec

**Issues Found:**

#### CRIT-001: Environment Variable Injection
```rust
// implementations/containerd-shim/src/main.rs:126-134
let runtime = env::var("OCI_RUNTIME")
    .unwrap_or_else(|_| "runc".to_string());

// VULNERABLE: runtime used directly in Command::new()
Command::new(&runtime)  // ‚Üê Attacker controls this!
    .arg("run")
    .spawn()?;
```

**Attack:**
```bash
export OCI_RUNTIME="runc; rm -rf /"
# Executes: runc; rm -rf / run
```

**Fix:**
```rust
let runtime = env::var("OCI_RUNTIME")
    .unwrap_or_else(|_| "runc".to_string());

// Whitelist allowed runtimes
let allowed = ["runc", "crun", "youki", "gvisor"];
if !allowed.contains(&runtime.as_str()) {
    return Err("Invalid OCI runtime");
}

// Verify binary exists and is executable
let runtime_path = which::which(&runtime)
    .map_err(|_| "Runtime not found in PATH")?;

Command::new(runtime_path)  // Use PathBuf, not String
    .arg("run")
    .spawn()?;
```

#### CRIT-002: Shell Injection in Bash Script
```bash
# examples/axiom-smt-runner/solver-runner.sh:98
exec timeout "${TIMEOUT_SEC}s" $CMD "$SCRIPT_FILE"
#                                 ^^^^  ‚Üê Unquoted!
```

**Attack:**
```bash
SCRIPT_FILE="proof.smt2; cat /etc/passwd"
# Executes: timeout 300s z3 proof.smt2; cat /etc/passwd
```

**Fix:**
```bash
exec timeout "${TIMEOUT_SEC}s" "$CMD" "$SCRIPT_FILE"
#                                ^^^^   ^^^^^^^^^^^^
# Always quote variables!
```

**Estimated Effort:** 2-4 hours (fix both bugs + test)

---

== HIGH PRIORITY Missing Components

=== 5. QUIC / HTTP/3 Support

**Status:** NOT AVAILABLE (Deno limitation)

**Affected Repos:**
- ‚ùå Svalinn: Deno doesn't support QUIC yet
- ‚ùå Cerro Torre: Uses HTTP/2 for registry client
- ‚ùå V√∂r√∞r: Uses HTTP/2 via Rust reqwest

**Impact:**
- Slower TLS handshakes (1-RTT vs 0-RTT with QUIC)
- No multiplexing without head-of-line blocking
- Suboptimal for mobile/lossy networks

**Fix Required:**

**For Svalinn:**
Monitor Deno roadmap: https://github.com/denoland/deno/issues/9900

**For Cerro Torre/V√∂r√∞r:**
Switch to Rust hyper + h3 crate:
```toml
# Cargo.toml
hyper = { version = "1.0", features = ["http3"] }
h3 = "0.0.3"
quinn = "0.10"  # QUIC implementation
```

**Estimated Effort:**
- Svalinn: 6-12 months (wait for Deno)
- Cerro Torre/V√∂r√∞r: 1-2 weeks (Rust HTTP/3 client)

---

=== 6. XChaCha20-Poly1305 Cipher Suite

**Status:** NOT AVAILABLE (Deno/OpenSSL limitation)

**Affected Repos:**
- ‚ùå Svalinn: Deno's BoringSSL doesn't expose XChaCha20-Poly1305
- ‚ùå Cerro Torre: Uses standard OpenSSL (ChaCha20-Poly1305, not XChaCha20)

**Impact:**
- Smaller nonce space (96-bit vs 192-bit)
- Higher risk of nonce reuse with ChaCha20-Poly1305

**Fix Required:**

**Option 1: Custom TLS Build**
```bash
# Build Deno with custom BoringSSL
git clone https://github.com/google/boringssl
# Patch to enable XChaCha20-Poly1305
# Rebuild Deno with custom BoringSSL
```

**Option 2: Application-Layer Encryption**
```typescript
// Use libsodium-wrappers for XChaCha20-Poly1305
import sodium from "https://deno.land/x/sodium/mod.ts";

const encrypted = sodium.crypto_aead_xchacha20poly1305_ietf_encrypt(
  message,
  additionalData,
  nonce,   // 192-bit nonce
  key
);
```

**Estimated Effort:**
- Option 1: 2-3 weeks (custom Deno build)
- Option 2: 2-3 days (app-layer crypto)

---

=== 7. HKDF-SHAKE512

**Status:** NOT AVAILABLE (standard HKDF only)

**Affected Repos:**
- ‚ùå Svalinn: Deno Web Crypto has HKDF-SHA256/SHA512 only
- ‚ùå Cerro Torre: Uses standard HKDF (no SHAKE512)

**Impact:**
- Weaker KDF (SHA-512 vs SHAKE512)
- No quantum resistance in key derivation

**Fix Required:**

Use custom HKDF-SHAKE512 implementation:
```typescript
// Deno implementation
import { shake512 } from "https://deno.land/std/crypto/shake.ts";

function hkdfShake512(ikm: Uint8Array, salt: Uint8Array, info: Uint8Array, length: number): Uint8Array {
  // HKDF-Extract
  const prk = shake512(new Uint8Array([...salt, ...ikm]), 64);

  // HKDF-Expand
  const okm = new Uint8Array(length);
  let t = new Uint8Array(0);
  let n = Math.ceil(length / 64);

  for (let i = 0; i < n; i++) {
    t = shake512(new Uint8Array([...t, ...info, i + 1]), 64);
    okm.set(t.slice(0, Math.min(64, length - i * 64)), i * 64);
  }

  return okm;
}
```

**Estimated Effort:** 1-2 days

---

=== 8. ChaCha20-DRBG Deterministic RNG

**Status:** NOT IMPLEMENTED (uses OS RNG)

**Affected Repos:**
- ‚ùå All repos use `/dev/urandom` via OS

**Impact:**
- Non-deterministic randomness (can't reproduce test failures)
- No deterministic key generation for testing

**Fix Required:**

**Use Case:** Testing and reproducibility, NOT production secrets

```rust
// Rust implementation
use chacha20::ChaCha20;
use rand_core::{RngCore, SeedableRng};

struct ChaCha20Drbg {
    cipher: ChaCha20,
}

impl ChaCha20Drbg {
    fn new(seed: [u8; 32]) -> Self {
        Self { cipher: ChaCha20::new(&seed.into(), &[0u8; 12].into()) }
    }
}

impl RngCore for ChaCha20Drbg {
    fn next_u32(&mut self) -> u32 {
        let mut bytes = [0u8; 4];
        self.fill_bytes(&mut bytes);
        u32::from_le_bytes(bytes)
    }

    fn fill_bytes(&mut self, dest: &mut [u8]) {
        self.cipher.apply_keystream(dest);
    }
}
```

**Estimated Effort:** 1-2 days

---

== MEDIUM PRIORITY Missing Components

=== 9. Ed448 Signature Support

**Status:** NOT IMPLEMENTED (Ed25519 only)

**Affected Repos:**
- ‚ùå Cerro Torre: `cerro_crypto.ads` has Ed25519 only
- ‚ùå V√∂r√∞r: No Ed448 support
- ‚ùå verified-container-spec: Spec mandates Ed25519 only

**Impact:**
- Weaker signatures (Ed25519 = 128-bit security, Ed448 = 224-bit)
- Not compliant with svalinn-project spec (which requires Ed448)

**Fix Required:**

```ada
-- src/core/cerro_crypto.ads
-- Add Ed448 types
subtype Ed448_Key_Index is Positive range 1 .. 57;
type Ed448_Public_Key is array (Ed448_Key_Index) of Unsigned_8;

subtype Ed448_Signature_Index is Positive range 1 .. 114;
type Ed448_Signature is array (Ed448_Signature_Index) of Unsigned_8;

function Verify_Ed448
   (Message   : String;
    Signature : Ed448_Signature;
    Public_Key: Ed448_Public_Key) return Boolean
   with Global => null,
        Pre    => Message'Length <= Max_Hash_Input_Length;
```

**Library:** Use libsodium or libdecaf for Ed448

**Estimated Effort:** 1-2 weeks

---

=== 10. SPHINCS+ Fallback Signature

**Status:** NOT IMPLEMENTED

**Affected Repos:**
- ‚ùå Cerro Torre: No SPHINCS+ support
- ‚ùå V√∂r√∞r: No SPHINCS+ verification

**Impact:**
- No conservative PQ fallback if ML-DSA-87 breaks
- SPHINCS+ is hash-based (more conservative than lattice-based)

**Fix Required:**

```ada
-- src/core/ct_pqcrypto.ads
type SPHINCS_Plus_Public_Key is array (1 .. 64) of Unsigned_8;
type SPHINCS_Plus_Signature is array (1 .. 49_856) of Unsigned_8;

function Verify_SPHINCS_Plus
   (Message   : String;
    Signature : SPHINCS_Plus_Signature;
    Public_Key: SPHINCS_Plus_Public_Key) return Boolean;
```

**Library:** liboqs supports SPHINCS+

**Estimated Effort:** 1 week (after ML-DSA-87 is done)

---

=== 11. BLAKE3-512 (512-bit Output)

**Status:** PARTIAL (BLAKE3-256 exists)

**Affected Repos:**
- ‚ö†Ô∏è Cerro Torre: Has BLAKE3 but only 256-bit output
- ‚ùå V√∂r√∂d√∂r: No BLAKE3 at all (could add)

**Impact:**
- Weaker hashing for database indexes (256-bit vs 512-bit)
- Not compliant with svalinn-project spec

**Fix Required:**

```ada
-- src/core/cerro_crypto.ads
subtype Blake3_512_Index is Positive range 1 .. 64;
type Blake3_512_Digest is array (Blake3_512_Index) of Unsigned_8;

function Compute_Blake3_512 (Data : String) return Blake3_512_Digest
   with Global => null,
        Post   => Compute_Blake3_512'Result'Length = 64;
```

**Estimated Effort:** 2-3 days

---

=== 12. SHAKE3-512 (vs SHAKE256)

**Status:** PARTIAL (SHAKE256 implemented)

**Affected Repos:**
- ‚ö†Ô∏è Cerro Torre: Has SHAKE256, not SHAKE3-512
- ‚ùå V√∂r√∞r: No SHAKE support

**Impact:**
- SHAKE3 is stronger than SHAKE256 (post-quantum margin)
- Svalinn-project spec requires SHAKE3-512

**Fix Required:**

**Note:** SHAKE3 is not yet standardized (draft FIPS 202 update)

**Recommendation:** Wait for SHAKE3 standardization, use SHAKE256 for now

**Estimated Effort:** N/A (wait for standard)

---

=== 13. Virtuoso VOS Database

**Status:** NOT IMPLEMENTED

**Affected Repo:** V√∂r√∞r

**Impact:**
- Svalinn-project spec requires Virtuoso VOS for semantic XML/GraphQL
- V√∂r√∞r currently has no database for policy storage

**Fix Required:**

**Option 1: Virtuoso VOS (as per spec)**
```bash
# Install Virtuoso
sudo dnf install virtuoso-opensource

# Configure for SPARQL 1.2
# Add RDF store for policy definitions
```

**Option 2: PostgreSQL (simpler MVP)**
```bash
# Use PostgreSQL with JSONB for policies
sudo dnf install postgresql

# Schema:
CREATE TABLE policies (
  id TEXT PRIMARY KEY,
  version TEXT,
  requirements JSONB,
  allowed_registries TEXT[],
  audit_log_path TEXT
);
```

**Recommendation:** Use PostgreSQL for MVP, migrate to Virtuoso in v2.0

**Estimated Effort:**
- PostgreSQL: 1 week
- Virtuoso VOS: 3-4 weeks

---

=== 14. WCAG 2.3 AAA Accessibility

**Status:** NOT IMPLEMENTED

**Affected Repo:** V√∂r√∞r (ReScript browser UI)

**Impact:**
- If V√∂r√∞r builds a browser UI (MCP adapter), must meet WCAG 2.3 AAA
- Currently no UI, so not urgent

**Fix Required:**

When building UI:
```typescript
// Use semantic HTML + ARIA
<button
  aria-label="Verify container signature"
  aria-describedby="verify-help"
  onClick={verifySignature}
>
  Verify
</button>

<div id="verify-help" role="tooltip">
  Checks ML-DSA-87 and Ed448 signatures against trust store
</div>

// Color contrast ratio ‚â• 7:1 (AAA)
// Keyboard navigation support
// Screen reader tested
```

**Estimated Effort:** 2-3 weeks (if building UI)

---

== LOW PRIORITY Missing Components

=== 15. IPv6-only Mode

**Status:** DUAL-STACK (IPv4 + IPv6)

**Affected Repos:**
- ‚ö†Ô∏è All repos support both IPv4 and IPv6
- No toggle to disable IPv4

**Impact:**
- IPv4 is deprecated (svalinn-project spec requires IPv6-only)
- Dual-stack increases attack surface

**Fix Required:**

```bash
# Add flag to disable IPv4
ct verify --ipv6-only bundle.ctp

# Svalinn config
{
  "network": {
    "ipv6_only": true  // Reject IPv4 connections
  }
}
```

**Estimated Effort:** 1-2 days

---

=== 16. User-Friendly Hash Names

**Status:** NOT IMPLEMENTED

**Affected Repos:**
- ‚ùå All repos use hex for hashes
- No Base32 + wordlist mapping

**Impact:**
- Bundle hashes like `sha256:3f8d9a2b...` are not human-friendly
- Svalinn-project spec suggests `Gigantic-Giraffe-7` style names

**Fix Required:**

```ada
-- src/core/cerro_crypto.ads
function Hash_To_Friendly_Name (Hash : SHA256_Digest) return String
   with Post => Hash_To_Friendly_Name'Result'Length <= 64;

-- Implementation:
-- 1. SHAKE256(hash) ‚Üí 128 bits
-- 2. Base32 encode ‚Üí 26 characters
-- 3. Map to wordlist: "Adjective-Noun-Number"
--    Example: "Gigantic-Giraffe-7"
```

**Wordlist:** PGP word list or similar

**Estimated Effort:** 2-3 days

---

=== 17. Argon2id Password Hashing

**Status:** NOT APPLICABLE (no user passwords)

**Impact:** None (container tooling doesn't use passwords)

**Recommendation:** Skip this requirement (out of scope)

---

## Summary Table: Missing Components by Priority

| Priority | Component | Repos | Effort | Risk |
|----------|-----------|-------|--------|------|
| üî¥ **CRITICAL** | ML-DSA-87 | Cerro Torre, V√∂r√∞r | 4-8 weeks | Quantum vulnerability |
| üî¥ **CRITICAL** | PQ-TLS (Kyber-1024) | Svalinn | 2-3 months | Quantum vulnerability |
| üî¥ **CRITICAL** | OWASP ModSecurity/firewalld | Svalinn | 1 week | Web attacks (SQLi, XSS, SSRF) |
| üî¥ **CRITICAL** | Command injection fixes | verified-container-spec | 2-4 hours | RCE (CVSS 9.0) |
| üü° **HIGH** | QUIC/HTTP/3 | Svalinn, Cerro Torre, V√∂r√∞r | 1-2 weeks (Rust) | Performance degradation |
| üü° **HIGH** | XChaCha20-Poly1305 | Svalinn | 2-3 days | Nonce reuse risk |
| üü° **HIGH** | HKDF-SHAKE512 | Svalinn | 1-2 days | Weaker KDF |
| üü° **HIGH** | ChaCha20-DRBG | All | 1-2 days | Non-deterministic tests |
| üü¢ **MEDIUM** | Ed448 | Cerro Torre, V√∂r√∞r | 1-2 weeks | Weaker classical signatures |
| üü¢ **MEDIUM** | SPHINCS+ | Cerro Torre | 1 week | No PQ fallback |
| üü¢ **MEDIUM** | BLAKE3-512 | Cerro Torre | 2-3 days | Weaker hashing |
| üü¢ **MEDIUM** | SHAKE3-512 | All | N/A (wait for standard) | Minor security margin |
| üü¢ **MEDIUM** | Virtuoso VOS | V√∂r√∞r | 3-4 weeks | No semantic policies |
| üü¢ **MEDIUM** | WCAG 2.3 AAA | V√∂r√∞r | 2-3 weeks | Accessibility compliance |
| ‚ö™ **LOW** | IPv6-only mode | All | 1-2 days | Legacy compatibility |
| ‚ö™ **LOW** | Friendly hash names | All | 2-3 days | UX improvement |
| ‚ö™ **LOW** | Argon2id | N/A | N/A | Out of scope |

---

## Immediate Action Items

### This Week (High Impact, Low Effort)

1. **Fix command injection bugs** (2-4 hours)
   ```bash
   cd /var/mnt/eclipse/repos/verified-container-spec
   # Fix CRIT-001 and CRIT-002
   ```

2. **Add OWASP ModSecurity configs** (1 week)
   ```bash
   cd /var/mnt/eclipse/repos/svalinn
   mkdir -p config/{firewalld,modsecurity}
   # Add configs per above
   ```

3. **Add security headers to Svalinn** (1 day)
   ```bash
   # Edit src/middleware/Security.res
   # Add HSTS, CSP, X-Frame-Options, etc.
   ```

### This Month (Critical Path)

1. **Implement ML-DSA-87 in Cerro Torre** (4-8 weeks)
   - Add liboqs Ada bindings
   - Test CT-SIG-02 hybrid signatures

2. **Research Deno PQ-TLS status** (2-3 days)
   - Check if Deno roadmap has PQ-TLS
   - Evaluate nginx frontend option

### This Quarter (Remaining Gaps)

1. Implement V√∂r√∞r ML-DSA-87 verification
2. Add QUIC/HTTP/3 to Rust components
3. Implement Ed448 support
4. Add SPHINCS+ fallback

---

## Conclusion

**Total Missing Components:** 17

**Critical (blocking production):** 4
**High priority:** 4
**Medium priority:** 7
**Low priority:** 2

**Estimated Total Effort:** 6-9 months to full svalinn-project compliance

**Biggest Blockers:**
1. ML-DSA-87 implementation (no PQ signatures)
2. PQ-TLS in Svalinn (Deno limitation)
3. OWASP ModSecurity/firewalld (no WAF defenses)
4. Command injection bugs (active security vulnerabilities)

**Recommendation:** Fix command injection THIS WEEK, then prioritize ML-DSA-87 implementation over next 2 months.
